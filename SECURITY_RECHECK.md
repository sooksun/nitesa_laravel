# üîê ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Security Recheck)

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** _______________  
**‡∏£‡∏∞‡∏ö‡∏ö:** NITESA - ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏¥‡πÄ‡∏ó‡∏® ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤

---

## üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

| ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|--------|--------|----------|
| CSRF Protection | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏° web |
| Authentication | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | Session-based, ‡∏°‡∏µ guest/auth middleware |
| Authorization (Attachment) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡πà‡∏≠‡∏ô download/view |
| Authorization (Supervision) | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ show |
| Login Throttle | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏à‡∏≥‡∏Å‡∏±‡∏î 5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ï‡πà‡∏≠ IP |
| API Throttle | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | 60 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ |
| File Access | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà + ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡∏≤‡∏° supervision |
| Input Validation | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡πÉ‡∏ä‡πâ validation / Form Request |
| SQL Injection | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡πÉ‡∏ä‡πâ Eloquent/Query Builder |
| XSS | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | Blade escape, ‡πÉ‡∏ä‡πâ e() ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô |
| Mass Assignment | ‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß | ‡πÉ‡∏ä‡πâ $fillable ‡∏Ñ‡∏£‡∏ö |

---

## ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

### 1. ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô IDOR (Insecure Direct Object Reference)

**Attachment (‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î/‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå):**
- ‡πÉ‡∏ä‡πâ `authorizeAttachment()` ‡πÉ‡∏ô `AttachmentController`
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡πà‡∏≤‡∏ô `User::canAccessSupervision($attachment->supervision)`
- ‡∏Å‡∏é: Admin/Executive ‡∏î‡∏π‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î, Supervisor ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö, School ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà PUBLISHED

**Supervision (‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏¥‡πÄ‡∏ó‡∏®):**
- ‡πÉ‡∏ô `SupervisionShow::mount()` ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `$user->canAccessSupervision($supervision)` ‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‚Üí `abort(403)`

### 2. ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Brute Force (Login)

- ‡πÄ‡∏û‡∏¥‡πà‡∏° Rate Limiter ‡∏ä‡∏∑‡πà‡∏≠ `login`: **5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ï‡πà‡∏≠ IP**
- ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö route `POST /login` ‡∏ú‡πà‡∏≤‡∏ô middleware `throttle:login`
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô `RouteServiceProvider::boot()`

### 3. CSRF

- `VerifyCsrfToken` ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏° middleware `web`
- ‡πÑ‡∏°‡πà‡∏°‡∏µ URI ‡πÉ‡∏ô `$except` (‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏∏‡∏Å request ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô state)
- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ä‡πâ `@csrf` / `csrf_field()`

### 4. ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå (Attachment)

- ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà: `Storage::exists()` / `$attachment->fileExists()`
- ‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å path ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô DB ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö path ‡∏à‡∏≤‡∏Å user)
- ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô Response ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å model (‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏°‡∏µ path traversal)

### 5. API

- ‡πÉ‡∏ä‡πâ `auth:sanctum` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö route ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
- ‡πÉ‡∏ä‡πâ `throttle:api` (60 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ)
- ‡∏ö‡∏≤‡∏á route ‡πÉ‡∏ä‡πâ middleware `role:ADMIN,EXECUTIVE` ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö

### 6. Import Template

- `ImportController::downloadTemplate($type)` ‡πÉ‡∏ä‡πâ whitelist ‡∏Ñ‡πà‡∏≤ `$type` ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- path ‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å `public_path($filename)` ‡πÇ‡∏î‡∏¢ `$filename` ‡∏°‡∏≤‡∏à‡∏≤‡∏Å whitelist ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ path traversal

---

## üîß ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

### User::canAccessSupervision()

```php
public function canAccessSupervision(Supervision $supervision): bool
{
    if ($this->isAdmin() || $this->isExecutive()) return true;
    if ($this->isSupervisor()) {
        return $supervision->userId === $this->id
            || $this->assignedSchools()->where('schools.id', $supervision->schoolId)->exists();
    }
    if ($this->isSchool()) {
        return $supervision->status === SupervisionStatus::PUBLISHED;
    }
    return false;
}
```

### Login Throttle (RouteServiceProvider)

```php
RateLimiter::for('login', function (Request $request) {
    return Limit::perMinute(5)->by($request->ip());
});
```

### Route Login

```php
Route::post('/login', [LoginController::class, 'login'])->middleware('throttle:login');
```

---

## ‚ö†Ô∏è ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô)

1. **Content-Disposition filename**  
   ‡∏ñ‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏´‡∏£‡∏∑‡∏≠ non-ASCII ‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ RFC 5987 (filename*=UTF-8'') ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡∏Å encoding

2. **Session**  
   - ‡πÉ‡∏ä‡πâ `SESSION_SECURE_COOKIE=true` ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô HTTPS  
   - ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ `SESSION_ENCRYPT=true` ‡πÉ‡∏ô production

3. **Password**  
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤ production ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô default ‡∏à‡∏≤‡∏Å seeder  
   - ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î

4. **Audit**  
   - ‡πÉ‡∏ä‡πâ Activity Log ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏î‡∏π/‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î attachment, ‡∏î‡∏π supervision)

---

## üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ recheck ‡∏ô‡∏µ‡πâ

- `app/Providers/RouteServiceProvider.php` ‚Äì ‡πÄ‡∏û‡∏¥‡πà‡∏° `RateLimiter::for('login', ...)`
- `routes/web.php` ‚Äì ‡πÄ‡∏û‡∏¥‡πà‡∏° `->middleware('throttle:login')` ‡∏ó‡∏µ‡πà POST login
- `app/Livewire/Supervision/SupervisionShow.php` ‚Äì ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô `mount()`
- `app/Http/Controllers/AttachmentController.php` ‚Äì ‡∏°‡∏µ `authorizeAttachment()` ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)
- `app/Models/User.php` ‚Äì ‡∏°‡∏µ `canAccessSupervision()` ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ

- ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Supervision ‡πÅ‡∏•‡∏∞ Attachment ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó
- ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô (login throttle) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á brute force
- CSRF, Validation, ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Eloquent/Query Builder ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (XSS) ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏∏‡∏î‡∏≠‡∏∑‡πà‡∏ô (‡πÄ‡∏ä‡πà‡∏ô policy, middleware ‡πÄ‡∏û‡∏¥‡πà‡∏°, ‡∏´‡∏£‡∏∑‡∏≠ hardening ‡∏≠‡∏∑‡πà‡∏ô) ‡∏ö‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
